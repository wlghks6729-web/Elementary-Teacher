
<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>두 자리 ÷ 한 자리 챗봇형 튜터</title>
    <meta name="description" content="3학년을 위한 두 자리 ÷ 한 자리 나눗셈 학습 앱 (위치적 기수법 강조)" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-slate-50 text-slate-900">
    <div class="max-w-5xl mx-auto px-4 py-8">
      <div class="mb-4 flex items-center justify-between">
        <h1 class="text-2xl md:text-3xl font-bold">두 자리 ÷ 한 자리 챗봇형 튜터</h1>
        <div class="flex items-center gap-4">
          <label class="text-sm flex items-center gap-2 cursor-pointer select-none">
            <input id="teacherMode" type="checkbox" />
            교사용 풀이 표시
          </label>
          <a href="README.html" class="text-sm underline">사용 안내</a>
        </div>
      </div>
      <div id="app"></div>
      <footer class="mt-10 text-xs text-slate-500">
        © 2025 학습 튜터 • GitHub Pages/Netlify/Vercel로 자유 배포 가능
      </footer>
    </div>

    <script type="text/babel">
      const { useMemo, useState } = React;

      function makeProblem() {
        let divisor = Math.floor(Math.random() * 8) + 2;
        let dividend = Math.floor(Math.random() * 90) + 10;
        if (Math.random() < 0.3) {
          dividend = divisor * (Math.floor(Math.random() * 9) + 1);
        }
        return { dividend, divisor };
      }

      function solve(dividend, divisor) {
        const tens = Math.floor(dividend / 10);
        const ones = dividend % 10;
        const tensEach = Math.floor(tens / divisor);
        const tensRem = tens % divisor;
        const onesTotal = ones + tensRem * 10;
        const onesEach = Math.floor(onesTotal / divisor);
        const onesRem = onesTotal % divisor;
        const quotient = tensEach * 10 + onesEach;
        const remainder = onesRem;
        return { tens, ones, tensEach, tensRem, onesTotal, onesEach, onesRem, quotient, remainder };
      }

      const Pill = ({ children }) => (
        <span className="inline-block rounded-full px-3 py-1 text-sm border shadow-sm bg-white">{children}</span>
      );

      const StepCard = ({ title, children, accent=false }) => (
        <div className={"rounded-2xl p-4 md:p-5 shadow border " + (accent ? "bg-blue-50 border-blue-200" : "bg-white border-slate-200")}>
          <div className="font-semibold mb-2 flex items-center gap-2">
            <div className="w-2 h-2 rounded-full bg-current" /> {title}
          </div>
          <div className="prose prose-sm max-w-none">{children}</div>
        </div>
      );

      const NumberInput = ({ value, onChange, placeholder }) => (
        <input
          inputMode="numeric"
          className="w-24 md:w-28 rounded-xl border px-3 py-2 text-center text-lg bg-white border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-400"
          value={value}
          placeholder={placeholder}
          onChange={(e)=>onChange(e.target.value.replace(/[^0-9]/g, ""))}
        />
      );

      function LongDivisionBoard({ dividend, divisor, q, r, showAnswer, showProcess }) {
        const s = solve(dividend, divisor);
        const qShow = showAnswer ? s.quotient : q;
        const rShow = showAnswer ? s.remainder : r;

        return (
          <div className="inline-block p-3 rounded-2xl border bg-white border-slate-300">
            <div className="flex items-start gap-2">
              <div className="pt-2 text-lg">{divisor}</div>
              <div className="relative">
                <div className="text-xl font-semibold text-right mb-1">{qShow ?? "__"}</div>
                <div className="border-t-2 border-slate-700 w-full text-center text-2xl tracking-widest font-semibold">
                  {dividend}
                </div>
              </div>
            </div>
            <div className="text-right text-sm mt-1">나머지: <span className="font-semibold">{rShow ?? "_"}</span></div>
            {showProcess && (
              <div className="mt-3 text-sm">
                <div>① 십 나누기: {Math.floor(dividend/10)}십 → 각자 {s.tensEach}십, 남은 {s.tensRem}십</div>
                <div>② 남은 십을 일로: {s.tensRem}십 → {s.tensRem*10}일, 합쳐서 {s.ones}+{s.tensRem*10}={s.onesTotal}</div>
                <div>③ 일 나누기: {s.onesTotal} ÷ {divisor} → 각자 {s.onesEach}개, 남은 {s.onesRem}개</div>
              </div>
            )}
          </div>
        );
      }

      function DivisionTutor() {
        const [{ dividend, divisor }, setProb] = useState(makeProblem());
        const s = useMemo(() => solve(dividend, divisor), [dividend, divisor]);

        const [tensEach, setTensEach] = useState("");
        const [onesEach, setOnesEach] = useState("");
        const [remainder, setRemainder] = useState("");
        const [showHints, setShowHints] = useState(false);
        const [showProcess, setShowProcess] = useState(false);
        const [teacherMode, setTeacherMode] = useState(false);

        React.useEffect(() => {
          const el = document.getElementById("teacherMode");
          if (!el) return;
          const fn = () => setTeacherMode(el.checked);
          el.addEventListener("change", fn);
          return () => el.removeEventListener("change", fn);
        }, []);

        const tensCorrect = tensEach !== "" && Number(tensEach) === s.tensEach;
        const onesCorrect = onesEach !== "" && Number(onesEach) === s.onesEach;
        const remCorrect  = remainder !== "" && Number(remainder) === s.remainder;

        const qNow = (tensEach !== "" && onesEach !== "") ? Number(tensEach) * 10 + Number(onesEach) : undefined;

        function next() {
          setProb(makeProblem());
          setTensEach(""); setOnesEach(""); setRemainder("");
          setShowHints(false);
        }

        return (
          <div className="grid gap-4">
            <div className="text-xl font-bold text-center">문제: {dividend} ÷ {divisor}</div>

            <div className="flex flex-wrap items-center gap-3 justify-center">
              <Pill>나눠지는 수: <b>{dividend}</b></Pill>
              <Pill>나누는 수: <b>{divisor}</b></Pill>
              <Pill>문제 유형: 나머지 {s.remainder === 0 ? '없음' : '있음'}</Pill>
            </div>

            <div className="flex flex-wrap items-start gap-4">
              <LongDivisionBoard
                dividend={dividend}
                divisor={divisor}
                q={qNow}
                r={remainder === "" ? undefined : Number(remainder)}
                showAnswer={teacherMode}
                showProcess={showProcess || teacherMode}
              />
              <div className="flex flex-col gap-2">
                <button className="rounded-2xl px-4 py-2 border shadow bg-white hover:bg-slate-50" onClick={next}>🔄 다음 문제</button>
                <button className="rounded-2xl px-4 py-2 border shadow bg-white hover:bg-slate-50" onClick={()=>setShowHints(v=>!v)}>💡 힌트 {showHints ? "숨기기" : "보기"}</button>
                <button className="rounded-2xl px-4 py-2 border shadow bg-white hover:bg-slate-50" onClick={()=>setShowProcess(v=>!v)}>🧭 중간 과정 {showProcess ? "숨기기" : "보기"}</button>
              </div>
            </div>

            <StepCard title="1) 십의 자리 수를 먼저 나누어 보아요" accent>
              <p>{dividend}은(는) <b>{Math.floor(dividend/10)*10}</b>과 <b>{dividend%10}</b>로 이루어져 있어요.</p>
              <div className="flex items-center gap-2 mt-2">
                <NumberInput value={tensEach} onChange={setTensEach} placeholder="?" />
                <span>십씩</span>
                {tensEach !== "" && (
                  <span className={tensCorrect ? "text-green-600" : "text-red-600"}>
                    {tensCorrect ? "정답!" : `힌트: ${Math.floor(dividend/10)} ÷ ${divisor}`}
                  </span>
                )}
              </div>
            </StepCard>

            <StepCard title="2) 남은 '십'을 '일'로 바꾸어요 (받아내림 연결)">
              <p>남은 {s.tensRem}십 → {s.tensRem*10}일, 기존 {s.ones}와 합쳐 {s.onesTotal}일</p>
            </StepCard>

            <StepCard title="3) 이제 일의 자리 수를 나누어 보아요" accent>
              <div className="flex items-center gap-2">
                <span>{s.onesTotal} ÷ {divisor} =</span>
                <NumberInput value={onesEach} onChange={setOnesEach} placeholder="?" />
                <span>씩</span>
                {onesEach !== "" && (
                  <span className={onesCorrect ? "text-green-600" : "text-red-600"}>
                    {onesCorrect ? "정답!" : `힌트: ${s.onesTotal} ÷ ${divisor}`}
                  </span>
                )}
              </div>
            </StepCard>

            <StepCard title="4) 몫과 나머지를 정리해 보아요 (표준 세로셈)">
              <div className="flex flex-wrap items-center gap-3">
                <Pill>몫(십의 자리): <b>{tensEach === "" ? "_" : tensEach}</b></Pill>
                <Pill>몫(일의 자리): <b>{onesEach === "" ? "_" : onesEach}</b></Pill>
                <Pill>나머지: <NumberInput value={remainder} onChange={setRemainder} placeholder="?" /></Pill>
              </div>
              {remainder !== "" && (
                <div className={"mt-2 " + (remCorrect ? "text-green-600" : "text-red-600")}>
                  {remCorrect ? "정답이에요!" : `힌트: 남은 수는 ${s.onesRem}`}
                </div>
              )}
            </StepCard>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById('app')).render(<DivisionTutor />);
    </script>
  </body>
</html>
